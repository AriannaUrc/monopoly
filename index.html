<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="AlterVista - Editor HTML"/>
  <title></title>
</head>
<body>
  
  <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/styles.css">
    <title>Monopoly!</title>
  </head>
  <body>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <!--<script src="./js/script.js"></script> -->
    

    <div class="col-12 container">
      <div class="row"> <!--to center: justify-content-center-->
          <div class="w-75 h-100">
              <img id="gameBoard" src="img/board.jpg" class="img-fluid rounded float-left">
              <div  id="p2" style="" class="player-piece w-5 h-5 fill">
                <img id="P1Img" src="img/hat.png" class="img-fluid">
              </div>
          </div>

          <div class="row w-25">
            <div class="dice" id="dice">&#9860;</div>
            <div class="dice" id="dice2">&#9860;</div>
            <button id="roll-button" class="align-items-center text-center rounded">
              Roll<br>Dice
            </button>
            <div class="w-100 h-50"></div>
            <div id="buy-button" class="buy text-center w-100"><button>buy<br>property</button></div>
            <div class="build text-center w-100"><button> build<br>. house .</button></div>
            <div class="sell text-center w-100 "><button>sell<br>property</button></div>
          </div>

      </div>
  </div>

  <script>
  //memorizzare posizione tua e di altri giocatori
  //memorizzare possessioni tue e degli altri
  //memorizzare soldi posseduti
  //memorizzare quante volte di fila hai ottenuto un doppioTiro
  //se é tre vai in galera
  //memorizzare il monopoli delle strade

  //memorizzazione mossa: p1:x,y(posizione)_x,y(proprieta comprata);(tassa es.200$ per p3)p3:200;

  
  
  console.log("hello World");
  var buttonEl = document.getElementById("roll-button");
  var buttonBuy = document.getElementById("buy-button");
  var diceEl = document.getElementById("dice");
  var diceEl2 = document.getElementById("dice2");
  var luckyRolls1;
  var x;
  var y;
  var money1;
  var turno; //a chi tocca al momento
  var player;//giocatore assegnato
  var scambio; //a chi devo dare soldi alla fine
  var scambioQuantita;//quanti soldi gli devo dare
  const proprieta = new Array(11).fill().map(_ => new Array(11).fill(0))
  const costi = new Array(11).fill().map(_ => new Array(11).fill(0))
  costi[1][0] = 60; //cost[x][y]
  costi[3][0] = 60;
  costi[5][0] = 200;
  costi[6][0] = 100;
  costi[8][0] = 100;
  costi[9][0] = 100;
  costi[10][1] = 140;
  costi[10][2] = 150;
  costi[10][3] = 140;
  costi[10][4] = 160;
  costi[10][5] = 200;
  costi[10][6] = 180;
  costi[10][8] = 180;
  costi[10][9] = 200;
  costi[9][10] = 220;
  costi[7][10] = 220;
  costi[6][10] = 240;
  costi[5][10] = 200;
  costi[4][10] = 260;
  costi[3][10] = 260;
  costi[2][10] = 150;
  costi[1][10] = 280;
  costi[0][9] = 300;
  costi[0][8] = 300;
  costi[0][6] = 320;
  costi[0][5] = 200;
  costi[0][3] = 350;
  costi[0][1] = 400;

  
  proprieta[10][1] = 2;
  proprieta[10][2] = 2;
  proprieta[10][3] = 2;
  proprieta[10][4] = 2;
  proprieta[10][5] = 2;
  proprieta[10][6] = 2;


  inizioPartita();
  inizioTurno();

  

  function inizioPartita()
  {
    console.log("partita inizata");
    luckyRolls1 = 0; //fix refresh bug
    x = 0;//pos
    y = 0;//pos
    money1 = 0;
    player=1;//demo player 1
    turno = 1; //demo player 1
    MovePlayer(x,y,player);
  }
  

  function inizioTurno() //viene chiamata solo se il turno é quello del giocatore
  {
    buttonEl.disabled = false;
    buttonBuy.disabled = false;
  }

  function RollMovePlayer(roll, giocatore) //demo con player1
  {

    if(y==0) //sei sul lato in basso del tabellone
    {
      if(x+roll<=10) //se resti nel lato basso...
      {
        x = x+roll;
      }
      else{
        y= y + roll - (10-x);
        x=10;
      }
    }
    else if(x==10)//sei sul lato sinistro del tabellone
    {
      if(y+roll<=10)//resti sul lato sinistro...
      {
        y = y + roll;
      }
      else
      {
        x = x - roll + (10 - y);
        y = 10;
      }
    }
    else if(y==10) //sei sul lato superiore
    {
      if(x-roll>=0)//resti sul lato alto...
      {
        x = x - roll;
      }
      else
      {
        y = y - (roll - x);
        x = 0;
      }
    }
    else //sei sul lato destro
    {
      if(y-roll>0)//resti sul lato destro...
      {
        y = y - roll;
      }
      else
      {
        x = x + (roll - y);
        y = 0;
        //sei passato dal via!!!
        money1 += 200; //demo giocatore 1;
      }
    }
    MovePlayer(x, y, 1);
  }

  //accetta valori da 0-10 per muovere la pedina in tutto il tabellone
  function MovePlayer(xx,yy,p){
    let player = document.getElementById("p2");
    //console.log(player);
    player.style = "bottom: " + (5+yy*8.5) + "vh; right: " + (29+xx*6.2) + "%;";
  }

  function rollDice() {
    var rollResult = Math.floor(Math.random() * 6) + 1;
    var rollResult2 = Math.floor(Math.random() * 6) + 1;
    var diceFace = getDiceFace(rollResult);
    var diceFace2 = getDiceFace(rollResult2);
    diceEl.innerHTML = diceFace;
    diceEl2.innerHTML = diceFace2;
    if(rollResult == rollResult2) //doppio tiro
    {
      luckyRolls1 += 1;
      if(luckyRolls1 == 3)
      {
        MovePlayer(10, 0, player); //jail
        return;
      }
      else if(luckyRolls1>3){
        luckyRolls1 = 0;
      }
    }
    else if(luckyRolls1<3)//normale
    {
      luckyRolls1 = 0;
      //disattiva tutti i bottoni
      fineTurno();
      inizioTurno();
    }
    else //in jail
    {
      //disattiva tutti i bottoni
      fineTurno();
      inizioTurno();
      return;
      
    }
    
    RollMovePlayer(rollResult + rollResult2, player)
    taxes(x, y, player);

    if(money1<=0){
      console.log("Hai PERSO!")
    }
    console.log("lucky?: " + luckyRolls1);
    console.log("MONEY: " + money1)
  }

function getDiceFace(rollResult) {
  switch (rollResult) {
    case 1:
      return "&#9856;";
    case 2:
      return "&#9857;";
    case 3:
      return "&#9858;";
    case 4:
      return "&#9859;";
    case 5:
      return "&#9860;";
    case 6:
      return "&#9861;";
    default:
      return "";
  }
}

buttonEl.addEventListener("click", () => {
  rollDice()
});

buttonBuy.addEventListener("click", () => {
  buyProperty(x, y, player)
});
 

function buyProperty(x, y, p)
{
  //demo player1
  if(proprieta[x][y] == 0 && money1 - costi[x][y]>=0 && costi[x][y]!=0)
  {
    proprieta[x][y] = p;
    money1 = money1 - costi[x][y];
  }
  else{
    console.log("Non la puoi comprare!")
  }
  //detrarre il costo
  console.log(proprieta);
}

function taxes(x, y, p){
  if(proprieta[x][y]!=p && costi[x][y]!=0)
  {
    money1 -= costi[x][y];
    scambio = proprieta[x][y];
    scambioQuantita = costi[x][y];
  }
}


function getChanceCard(rollResult) { //usa i break!!!
  switch (rollResult) {
    case 1:
      //svogli le azioni della carta
      return "caso1";
    case 2:
      return "caso2";
    case 3:
      return "caso3";
    case 4:
      return "caso4";
    case 5:
      return "caso5";
    case 6:
      return "caso6";
    default:
      return "none";
  }
}


function CaselleAzioni(x, y, p) {
  switch (x) {
    //controlla colonna di destra
    case 0:
      switch (y) 
      {
        case 0:
          return;
        case 1:
          //svogli le azioni della carta
          return;
        case 2:
          return;
        case 3:
          return;
        case 4:
          return;
        case 5:
          return;
        case 6:
          return;
        case 7:
          return;
        case 8:
          return;
        case 9:
          return;
      }
      return;
    case 1:
      //svogli le azioni della carta
      return;
    case 2:
      return;
    case 3:
      return;
    case 4:
      return;
    case 5:
      return;
    case 6:
      return;
    case 7:
      return;
    case 8:
      return;
    case 9:
      return;

    //controlla colonna di sinistra
    case 10:
    switch (y) 
      {
        case 0:
          return;
        case 1:
          //svogli le azioni della carta
          return;
        case 2:
          return;
        case 3:
          return;
        case 4:
          return;
        case 5:
          return;
        case 6:
          return;
        case 7:
          return;
        case 8:
          return;
        case 9:
          return;
      }
      return;
    default:
      console.log("casella invalida")
      return;
  }
}



function fineTurno()
{
  console.log("fineee!!")
  buttonEl.disabled = true;
  buttonBuy.disabled = true;
  //cambia il turno
}

  </script>
</body>
</html>